# β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•
# π® gitpro - GitHub Profile Suite
# β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•β•
# 6μ‹κ°„λ§λ‹¤ μλ™μΌλ΅ ν”„λ΅ν•„ μ‹κ°ν™”λ¥Ό μ—…λ°μ΄νΈν•©λ‹λ‹¤.
# μλ™ μ‹¤ν–‰(workflow_dispatch)λ„ μ§€μ›ν•©λ‹λ‹¤.

name: π® gitpro - Update Profile

on:
  # 6μ‹κ°„λ§λ‹¤ μλ™ μ‹¤ν–‰
  schedule:
    - cron: '0 */6 * * *'

  # μλ™ μ‹¤ν–‰
  workflow_dispatch:

  # μ„¤μ • νμΌ λ³€κ²½ μ‹ μλ™ μ‹¤ν–‰
  push:
    branches: [main]
    paths:
      - 'gitpro.config.yml'

jobs:
  generate:
    runs-on: ubuntu-latest
    name: π® Generate Profile Visualizations

    permissions:
      contents: write

    steps:
      # 1. λ ν¬ μ²΄ν¬μ•„μ›ƒ
      - name: π“¥ Checkout repository
        uses: actions/checkout@v4

      # 2. Node.js ν™κ²½ μ„¤μ •
      - name: πΆ Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'
          cache: 'npm'

      # 3. μμ΅΄μ„± μ„¤μΉ
      - name: π“¦ Install dependencies
        run: npm ci

      # 4. TypeScript λΉλ“
      - name: π”¨ Build
        run: npm run build

      # 5. gitpro μ‹¤ν–‰
      - name: π® Run gitpro
        env:
          GH_TOKEN: ${{ secrets.GH_TOKEN }}
          GITHUB_TOKEN: ${{ secrets.GITHUB_TOKEN }}
        run: npm start

      # 6. λ³€κ²½μ‚¬ν•­ μ»¤λ°‹ & ν‘Έμ‹
      - name: π“¤ Commit and push changes
        run: |
          git config --local user.email "github-actions[bot]@users.noreply.github.com"
          git config --local user.name "github-actions[bot]"
          git add -A output/ state/ README.md
          git diff --staged --quiet || git commit -m "π® gitpro: Update profile visualizations"
          git push
